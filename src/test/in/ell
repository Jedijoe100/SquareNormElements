default(realprecision,38);
ellap(ellinit([1,0,1,4,-6]), 2)
ellap(ellinit([0,17]), 2)
ellap(ellinit([0, 0, 1, -1, 0]),2486246173)

testgroup(v,p)=
{ my(E,F,G,g);
  E=ellinit(v, 1); if(!E, next);
  E[13] = Mod(0,p); E *= Mod(1,p);/*allow singular curves*/
  G=ellgroup(E,p,1); if (G.no == 1, return);
  g=G.gen; if (!ellisoncurve(E,g), error(E, G));
  F=vector(#g,i, ellorder(E,g[i],G.no));
  if ((p <= 3 && F!=G.cyc) || (p > 3 && F[1] != G.cyc[1]),
    print("error:",v,":",F,":",G));
}
{
  for(x=10,63,
    my(p,E,G,g);
    p=nextprime(2^x);E=ellinit([0,0,1,2,3],1);
    G = ellgroup(E,p,1); if (!ellisoncurve(E,G.gen), error(E));
    if(ellorder(E,G.gen[1])!=G.cyc[1], error(E));
    print(p,":",ellgroup(E,p)));
  for(p=2,3,
    forvec(v=vector(5,i,[0,p-1]), testgroup(v,p)));
  forvec(v=vector(2,i,[0,4]), testgroup(v,5));
}
a=ffgen(ffinit(2,8),'a); E=ellinit([a,1,0,0,1]);
P=[a^3,ellordinate(E,a^3)[1]]; Q=ellmul(E,P,113);
e=elllog(E,P,Q,242)
ellmul(E,Q,e) == P

p=655637;
E=ellinit([123,47]*Mod(1,p));
X=1;until(Y!=[],X++;Y=ellordinate(E,X));
P=[X,Y[1]]; Q=ellmul(E,P,113);
o=ellorder(E,P, p+1-ellap(E,p))
e=elllog(E,P,Q,o)
ellmul(E,Q,e) == P

p=1073741827;
E=ellinit([1,3]*Mod(1,p));
G=[Mod(1050932506,p),Mod(12325986,p)];
P=ellmul(E,G,1023);
elllog(E,P,G)

ellorder(ellinit([0,2],1),[-1,-1]*Mod(1,997))

E = ellinit([-2147484185^2,0]);
elltors(E)
ellorder(E, [0,0])
ellorder(E, [2147484185, 0])
ellorder(E, [2147484185/3, 1/11])
E = ellinit([1,1]); P = [72, 611];
ellorder (E, ellmul(E, P, 20))

ellinit([a1,a2,a3,a4,a6]*Mod(1,5));
ellinit([a1,a2,a3,a4,a6]);
ellinit(ellfromj(0)).j
ellinit(ellfromj(1728)).j
ellinit(ellfromj(j)).j
ellinit(ellfromj(0*Mod(1,2))).j
ellinit(ellfromj(j*Mod(1,2))).j
ellinit(ellfromj(0*Mod(1,3))).j
ellinit(ellfromj(j*Mod(1,3))).j
a=ffgen(ffinit(2,5),'a);ellinit(ellfromj(a)).j
a=ffgen(ffinit(3,5),'a);ellinit(ellfromj(a)).j
elldivpol(ellinit([1,2,3,5,7]),4)
elldivpol(ellinit([0,0,0,0,1]),8)

\\#1185
ellwp(ellinit([0,-1,1,-10,-20]),x+O(x^12))

\\#1186
ellmul(ellinit([3,0]), [1,2], -quadgen(-4))

v = [ellwp,ellzeta,ellsigma]
e = ellinit([1,1]);
{
for (i = 1, #v,
  my(f = v[i]);
  print(f(e));
  print(f(e, x+O(x^10)));
)
}

\\ #1257
ellrootno(ellinit([0,-1,1,217,-282]))

\\ #1296
e=ellinit([0,-1,0,-33,62]);
ellztopoint(e,-2.5261979245524788020279452840822073870+0.E-36*I)

\\ #1308
ellinit([108/91,11664/8281,-6561/8281,708588/753571,-14348907/68574961]).disc

