default(echo,1);
allocatemem(20 * 10^6);
check(a,b) = my(t = abs((a-b)/b)); if (t, ceil(log(t)/log(10)), -oo);
\p96
check(intcirc(s=1, 0.5, zeta(s)), 1)
check(intlaplaceinv(x=2, 1, 1/x), 1)
m = intnumstep();
check(intlaplaceinv(x=2, 1, 1/x, m+1), 1)
check(intlaplaceinv(x=5, 1, 1/x), 1)
check(intlaplaceinv(x=100, 1, 1/x), 1)
A = intmellininv(s=2,4, gamma(s)^3);
tab = intfuncinit(t=[-oo, 4.5],[oo, 4.5], gamma(2+I*t)^3, 1);
check(intmellininvshort(2,4,tab), A)
f(x) = 1/(exp(x)-1) - exp(-x)/x;
F = truncate( f(t + O(t^7)) );
g(x) = if (x > 1e-18, f(x), subst(F,t,x));
check(intnum(x = 0, [oo,1],  f(x)), Euler)
check(intnum(x = 0, [oo,1],  g(x)), Euler)
check(intnum(x = 0, 1,  1/sqrt(x)), 2)
check(intnum(x = [0,-1/2], 1,  1/sqrt(x)), 2)

check(intnum(x = [0,-1/2], [oo,-3/2],  1/(sqrt(x)+x^(3/2))), Pi)
check(intnum(x = [-oo,-3/2], [oo,-3/2],  1/(1+abs(x)^(3/2))), 8*Pi/sqrt(27))

f(x)=if (x<0,1/(1+(-x)^(3/2)), 1/(1+x^(5/2)));
a=4*Pi/sqrt(27) + 2*(Pi/5)/sin(2*Pi/5);
check(intnum(x = [-oo,-3/2], [oo,-5/2], f(x)),a)
f(x)=if (x<0,1/(1+(-x)^(3/2)), exp(-x));
check(intnum(x = [-oo,-3/2], [oo,1], f(x)), 4*Pi/sqrt(27)+1)
f(x)=if (x<0,1/(1+(-x)^(3/2)), sin(x)/x);
check(intnum(x = [-oo,-3/2], [oo,-I], f(x)), 4*Pi/sqrt(27)+Pi/2)

f(x)=if (x<0,exp(2*x), 1/(1+x^(3/2)));
check(intnum(x = [-oo,2], [oo,-3/2], f(x)), 1/2+4*Pi/sqrt(27))
f(x)=if (x<0,exp(2*x), 1/(1+x^(5/2)));
check(intnum(x = [-oo,2], [oo,-5/2], f(x)), 1/2+2*(Pi/5)/sin(2*Pi/5))
f(x)=if (x<0,exp(2*x), exp(-x));
check(intnum(x = [-oo,2], [oo,1], f(x)), 3/2)
f(x)=if (x<0,exp(2*x), sin(x)/x);
check(intnum(x = [-oo,2], [oo,-I], f(x)), 1/2+Pi/2)

f(x)=if (x<0,sin(2*x)/x, 1/(1+x^(3/2)));
check(intnum(x = [-oo,-2*I], [oo,-3/2], f(x)), Pi/2+4*Pi/sqrt(27))
f(x)=if (x<0,sin(2*x)/x, 1/(1+x^(5/2)));
check(intnum(x = [-oo,-2*I], [oo,-5/2], f(x)), Pi/2+2*(Pi/5)/sin(2*Pi/5))
f(x)=if (x<0,sin(2*x)/x, exp(-x));
check(intnum(x = [-oo,-2*I], [oo,1], f(x)), Pi/2+1)
f(x)=if (x<0,sin(2*x)/x, sin(x)/x);
check(intnum(x = [-oo,-2*I], [oo,-I], f(x)), Pi)



check(intnum(x = 0, [oo,1], sin(x)/x), Pi/2)
check(intnum(x = 0, [oo,-I], sin(x)/x), Pi/2)
check(intnum(x = 0, [oo,-2*I], sin(2*x)/x), Pi/2)
A=intnum(x=0,1,(1-cos(x))/x^2)+intnum(x=1,oo,1/x^2)-intnum(x=1,[oo,I],cos(x)/x^2);
check(A, Pi/2)
check(intnum(x = 0, [oo, 1], sin(x)^3*exp(-x)), 3/10)
check(intnum(x = 0, [oo,-I], sin(x)^3*exp(-x)), 3/10)
tab = intnuminit(0,[oo,-I], m+1);
check(intnum(x = 0, oo, sin(x)^3*exp(-x), tab), 3/10)
check(intnum(x = 0, [oo, -I], x^2*sin(x)), -2)
tab = intnuminit(-1,1);
check(intnum(x=-1,1, intnum(y=-sqrt(1-x^2),sqrt(1-x^2),x^2+y^2,tab),tab), Pi/2)
\\
\p 308
a = sumpos(n=1, 1/(n^3+n+1));
b = sumpos(n=1, 1/(n^3+n+1), 1);
check(a, b)
tab = sumnuminit(2);
b = sumnum(n=1,2, 1/(n^3+n+1), tab);
check(a, b)
check(sumnum(n=1,2, 1/(n^3+n+1), tab, 1), a)
a = sumpos(n=1,1/(n^2+1));
b = sumpos(n=1,1/(n^2+1), 1);
check(a, b)
b = sumnum(n=1,2,1/(n^2+1),tab,1);
check(a, b)
check(sumnum(n=1,2,n^(-4/3),,1), zeta(4/3))
tab = sumnuminit([2,-3/2]);
check(sumnum(n=1,[2,-3/2],1/(n*sqrt(n)),tab,1), zeta(3/2))
\\
check(suminf(n=1, 2^(-n)), 1)
check(sumpos(n=1, 2^(-n)), 1)
check(sumnum(n=1,[2,log(2)],2^(-n), intnumstep()+1, 1), 1)
\\
tab = sumnuminit(2,,-1);
a = sumnumalt(n=1,2,1/(n^3+n+1),tab,1);
b = sumalt(n=1,(-1)^n/(n^3+n+1));
check(a, b)

\p96
T=intnuminitgen(t,0,[1],exp(2*sinh(t)));
check(intnum(x=0,[1],1/(1+x^2),T), Pi/2)
T=intnuminitgen(t,0,[[1],1],exp(t-exp(-t)));
check(intnum(x=0,[[1],1],exp(-x),T), 1)
intfourierexp(t=0,[[1],1], 1/2, exp(-t^2))
intfouriercos(t=0,[[1],1], 1/2, exp(-t^2))
intfouriersin(t=0,[[1],1], 1/2, exp(-t^2))

\p38
intnumromb(x=0,1,sin(x))
intnumromb(x=0,1,sin(x), 1)
intnumromb(x=1,100,exp(-x^2), 2)
intnumromb(x=0,1,sin(x)/x, 3)
\\ sloooow
\\intnumromb(x=0,110,x, 1)
\\intnumromb(x=-110,90,x, 1)
intnumromb(x=2,1,x, 1)

f(x) = -log(cos(x));
F = truncate( f(t + O(t^16)) );
g(x) = if (x > 1e-2, f(x), subst(F,t,x));
sumpos(n=1,g(1/n))
sumpos(n=0,0)

intnuminit([oo,1+I],[oo,""])
intnum(x=oo,oo,1)
intnum(x=-oo,-oo,1)
