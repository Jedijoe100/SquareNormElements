do(n)= my(k,z); if (k=ispower(n,,&z), print([k,z]));
{v = [
3^101*2^20,
3^101*2^101,
3^101*2^101*5,
2^20*3^15*5^5,
2^3*103^6,
2^5*103^10,
2^7*103^10,
2^15*103^10,
2^21*103^42,
2^35*103^70,
2^105*103^210,
103^100003
]; }

for (i=1, #v, do(v[i]))
for (i=1, 10^6, do(i))
\\#1259
do(-16)
do(-64)
do(-8)
do(-8 * 103^6)
do(-1/64)

for (i=1, #v, if (!ispowerful(v[i]), print(i)))
ispowerful(5^3*(10^1000+1)^2)

v = [1, 2^10, 2^15, 2^32, 2^64, 2^128];

/*
correct = vector(#v);
{
for (k = 1, #v,
  my(u = v[k], s,t);
  for(i=u, u+10^4,
    if ((a = ispower(i,,&p)) && isprime(p), s += a; t += p);
    if (isprime(i), s ++; t += i);
  );
  correct[k] = [s,t];
)
}
*/
{
for (k = 1, #v,
  my(u = v[k], s,t);
  s = sum(i=u, u+10^4, isprimepower(i));
  t = 0;for (i = u, u+10^4, if (isprimepower(i,&p), t += p));
  print([s,t]);
\\  if ([s,t] != correct[k], error(k))
)
}
