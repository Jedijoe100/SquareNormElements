Function: alinit
Section: algebras
C-Name: alinit
Prototype: GGDnD1,L,
Help: alinit(B, C, {v}, {flag = 1}): initialize the central simple algebra
 defined by data B, C. If flag = 1, compute a maximal order.
Doc: initialize the central simple algebra defined by data $B$, $C$ and
 variable $v$, as follows.

 \item (multiplication table) $B$ is the base number field $K$ in \tet{nfinit}
 form, $C$ is a ``multiplication table'' over $K$.
 As a $K$-vector space, the algebra is generated by a basis
 $(e_1 = 1,\dots, e_n)$; the table is given as a \typ{VEC} of $n$ matrices in
 $M_n(K)$, giving the left multiplication by the basis elements $e_i$, in the
 given basis.
 Assumes that $e_1= 1$ and $K[e_1,\dots,e_n]$ describes a central simple
 algebra over $K$; $v$ and $\fl$ are ignored.
 \bprog
 { m_i = [0,-1,0, 0;
          1, 0,0, 0;
          0, 0,0,-1;
          0, 0,1, 0];
   m_j = [0, 0,-1,0;
          0, 0, 0,1;
          1, 0, 0,0;
          0,-1, 0,0];
   m_k = [0, 0, 0, 0;
          0, 0,-1, 0;
          0, 1, 0, 0;
          1, 0, 0,-1];
   A = alinit([matid(4), m_i,m_j,m_k],  0); }
 @eprog represents (in a complicated way) the quaternion algebra $(-1,-1)_\Q$.
 See below for a simpler solution.

 \item (cyclic algebra) $B$ is an \var{rnf} structure associated to a cyclic
 number field extension $L/K$ of degree $d$, $C$ is a \typ{VEC}
 \kbd{[sigma,b]} with 2 components: \kbd{sigma} is a \typ{POLMOD} representing
 an automorphism generating $\text{Gal}(L/K)$, $b$ is an element in $K^*$. This
 represents the cyclic algebra~$(L/K,\sigma,b)$.
 \bprog
  ? Q = nfinit(y); T = polcyclo(5, 'x); F = rnfinit(Q, T);
  ? A = alinit(F, [Mod(x^2,T), 3]);
 @eprog defines the cyclic algebra $(L/\Q, \sigma, 3)$, where
 $L = \Q(\zeta_5)$ and $\sigma:\zeta\mapsto\zeta^2$ generates
 $\text{Gal}(L/\Q)$.

 \item (quaternion algebra, special case of the above) $B$ is an \var{nf}
 structure associated to a number field $K$, $C = [a,b]$ is a vector
 containing two elements of $K^*$ with $b$ not a square in $K$, returns the quaternion algebra $(a,b)_K$.
 The variable $v$ (\kbd{'x} by default) must have higher priority than the
 variable of $K$\kbd{.pol} and is used to represent elements in the splitting
 field $L = K[x]/(x^2-a)$.
 \bprog
  ? Q = nfinit(y); A = alinit(Q, [-1,-1]);  \\@com $(-1,-1)_\Q$
 @eprog

 \item (algebra/$K$ defined by local Hasse invariants)
 $B$ is an \var{nf} structure associated to a number field $K$,
 $C = [d, [\kbd{PR},h_f], h_i]$ is a triple
 containing an integer $d > 1$, a pair $[\kbd{PR}, h_f]$ describing the
 Hasse invariants at finite places, and $h_i$ the Hasse invariants
 at archimedean (real) places. A local Hasse invariant belongs to $(1/d)\Z/\Z
 \subset \Q/\Z$, and is given either as a \typ{FRAC} (lift to $(1/d)\Z$),
 a \typ{INT} or \typ{INTMOD} modulo $d$ (lift to $\Z/d\Z$); a whole vector
 of local invariants can also be given as a \typ{VECSMALL}, whose
 entries are handled as \typ{INT}s. \kbd{PR} is a list of prime ideals
 (\var{prid} structures), and $h_f$ is a vector of the same length giving the
 local invariants at those maximal ideals. The invariants at infinite real
 places are indexed by the real roots $K$\kbd{.roots}: if the Archimedean
 place $v$ is associated to the $j$-th root, the value of
 $h_v$ is given by $h_i[j]$.

 By class field theory, provided the local invariants $h_v$ sum to $0$, up
 to Brauer equivalence, there is a unique central simple algebra over $K$
 with given local invariants and trivial invariant elsewhere. In particular,
 up to isomorphism, there is a unique such algebra $A$ of degree $d$.

 We realize $A$ as a cyclic algebra through class field theory. The variable $v$
 (\kbd{'x} by default) must have higher priority than the variable of
 $K$\kbd{.pol} and is used to represent elements in the (cyclic) splitting
 field extension $L/K$ for $A$.

 \item (matrix algebra, toy example) $B$ is an \var{nf} structure associated
 to a number field $K$, $C = d$ is a positive integer. Returns a cyclic
 algebra isomorphic to the matrix algebra $M_d(K)$.

 In all cases, this function computes a maximal order for the algebra by default,
 which may require a lot of time. Setting $\fl = 0$ prevents this computation.
