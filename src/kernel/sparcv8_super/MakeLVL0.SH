# For SunOS
#   If __GNUC__, most level0 functions are "asm inline"
#   If not, they are "asm extern"
# For NextStep
#   We don't accept "asm inline" since it does not work (Ptitboul)
kercom=$src/kernel/sparcv8_micro
kernon=$src/kernel/none
ker=$src/kernel/$kernlvl0

if test "$osname" = "nextstep" 
then
  level0=$src/kernel/none/asm0.h
else
  level0="$kercom/level0_common.h $kernon/divll.h"
fi
level0="$kernon/bfffo.h $level0"

cat >> $file << EOT
kernel0.s: $kercom/level0_common.S
	cat $kercom/level0_common.S > level0.S
	\$(CPP) $KERNELCPPFLAGS level0.S |\
	   sed -e '/^#/d' -e '/^ *#line/d' -e 's/%  */%/g' > \$@

parilvl0.h: $level0
	cat $level0 > parilvl0.h

kernel\$(_O): kernel0.s
	\$(AS) \$(ASFLAGS) -o \$@ kernel0.s

EOT
