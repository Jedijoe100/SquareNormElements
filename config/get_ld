# Which Executable Linker ?
#
_ld_list='LD LDFLAGS LIBS runpathprexix LDused GNULDused'
case "$osname" in
  darwin) LIBS= ;;
  osf1)   LIBS='-lm -lots -lc';; # FIXME: why add -lc here ?
  *)      LIBS=-lm;;
esac

if test -z "$LD"; then
  case "$osname" in
    osf1)LD=$ld ;; # FIXME: Why not $CC ?
    *)   LD=$CC ;;
  esac
fi

# FIXME: user had better know what she's doing, when setting LD/LDFLAGS !
if test -z "$LDFLAGS"; then
  case "$osname-$arch" in
    osf1-*) # only case where $LD != $CC
        LDFLAGS='-std0 -call_shared /usr/lib/cmplrs/cc/crt0.o'
        case "$optimization" in
          full|profiling) LDFLAGS="-g0 -O4 $LDFLAGS";;
        esac ;;
    linux-*|cygwin*|freebsd-*) LDFLAGS="$cflags -Wl,-export-dynamic" ;;
    solaris-*) LDFLAGS=$cflags ;;
    os2-*)     LDFLAGS="$cflags -Zexe"
               case "$optimization" in
                 full) LDFLAGS="$LDFLAGS -s";;
               esac;;
    *)         LDFLAGS=$cflags ;;
  esac
fi

if test "$fastread" != yes; then
  echo $n ..."Which linker for building executables ? $c"
  dflt=$LD; rep=; . ./myread
  LD=$ans
fi

# Which Flags for Executable Linker?
#
if test "$fastread" != yes; then
  echo $n ..."With which flags ? $c"
  dflt=$LDFLAGS; rep=; . ./myread
  LDFLAGS=$ans
fi

echo "Executable linker is   $LD  $LDFLAGS"

LDused=$LD
GNULDused=
if test $LD=$CC -a -n "$__gnuc__"; then
  LDused=`$CC -print-prog-name=ld`
fi
if ($LDused -v 2>&1 | grep GNU > /dev/null); then GNULDused=yes; fi

case "$osname" in
  osf1) runpathprefix='-rpath ';;
  linux|cygwin*|freebsd) runpathprefix='-Wl,-rpath,';;
  solaris) runpathprefix='-R ';;
esac
